(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{212:function(e,t,n){},213:function(e,t,n){},365:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(30),i=n.n(r),o=(n(212),n(213),n(76)),s=n.n(o),l=n(108),d=n(373),u=n(368),j=n(369),b=n(82),p=n(104);n(218),n(219),n(220);p.a.initializeApp({apiKey:"AIzaSyDxVFevq_WCPzyCDa8MQWM5Sz_nTTG0-Hs",authDomain:"chat-app-c97d1.firebaseapp.com",projectId:"chat-app-c97d1",storageBucket:"chat-app-c97d1.appspot.com",messagingSenderId:"113429527145",appId:"1:113429527145:web:d07f048328382781ff00f8",measurementId:"G-66YZDW5J3D"}),p.a.analytics();var h=p.a.auth(),m=p.a.firestore(),O=p.a,x=n(103),f=n(55),v=function(e,t){m.collection(e).add(Object(f.a)(Object(f.a)({},t),{},{createdAt:O.firestore.FieldValue.serverTimestamp()}))},g=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],r=[],i=0;i<n;i++)a[i]=!1;return function e(i){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[i]=t[o],i===n-1&&r.push(c.join(" ")),e(i+1),a[o]=!1)}(0),r.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(x.a)(e),Object(x.a)(n))}),[])},y=n(8),I=d.a.Title,C=new O.auth.GoogleAuthProvider,w=new O.auth.FacebookAuthProvider;var N,R=function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.signInWithPopup(w);case 2:t=e.sent,n=t.additionalUserInfo,a=t.user,(null===n||void 0===n?void 0:n.isNewUser)&&v("user",{displayName:a.displayName,email:a.email,photoURL:a.photoURL,uid:a.uid,providerId:n.providerId,keywords:g(a.displayName)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.signInWithPopup(C);case 2:t=e.sent,n=t.additionalUserInfo,a=t.user,(null===n||void 0===n?void 0:n.isNewUser)&&v("user",{displayName:a.displayName,email:a.email,photoURL:a.photoURL,uid:a.uid,providerId:n.providerId,keywords:g(a.displayName)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)("div",{children:Object(y.jsx)(u.a,{justify:"center",style:{height:800},children:Object(y.jsxs)(j.a,{span:8,children:[Object(y.jsx)(I,{style:{textAlign:"center"},level:3,children:"Fun Chat"}),Object(y.jsx)(b.a,{style:{width:"100%",marginBottom:5},onClick:t,children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Google"}),Object(y.jsx)(b.a,{style:{width:"100%"},onClick:e,children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook"})]})})})},U=n(152),A=n(33),k=n(37),L=n(42),S=n(372),V=n(378),M=n(75),F=n(376),T=n(379),P=n(43),z=n(380),D=n(371),G=P.a.div(N||(N=Object(L.a)(["\n    margin-bottom: 10px;\n\n    .author {\n        margin-left: 5px;\n        font-weight: bold;\n    }\n\n    .date {terday a\n        margin-left: 10px;\n        font-size: 11px;\n        color: #a7a7a7;\n    }\n\n    .content {\n        margin-left: 30px;\n    }\n"])));function E(e){var t="";return e&&(t=(t=Object(D.a)(new Date(1e3*e),new Date)).charAt(0).toUpperCase()+t.slice(1)),t}var W=function(e){var t,n=e.text,a=e.displayName,c=e.createdAt,r=e.photoURL;return Object(y.jsxs)(G,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(V.a,{size:"small",src:r,children:r?"":null===a||void 0===a||null===(t=a.charAt(0))||void 0===t?void 0:t.toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"author",children:a}),Object(y.jsx)(d.a.Text,{className:"date",children:E(null===c||void 0===c?void 0:c.seconds)})]}),Object(y.jsx)("div",{children:Object(y.jsx)(d.a.Text,{className:"content",children:n})})]})},B=function(e,t){var n=Object(a.useState)([]),r=Object(k.a)(n,2),i=r[0],o=r[1];return c.a.useEffect((function(){var n=m.collection(e);if(t){if(!t.compareValue||!t.compareValue.length)return;n=n.where(t.fieldName,t.operator,t.compareValue)}var a=n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(f.a)(Object(f.a)({},e.data()),{},{id:e.id})}));o(t)}));return function(){a()}}),[e,t]),i},J=n(370),H=c.a.createContext();function K(e){var t=e.children,n=Object(a.useState)({}),r=Object(k.a)(n,2),i=r[0],o=r[1],s=Object(A.f)(),l=Object(a.useState)(!0),d=Object(k.a)(l,2),u=d[0],j=d[1];return c.a.useEffect((function(){var e=h.onAuthStateChanged((function(e){if(console.log({user:e}),e){var t=e.displayName,n=e.email,a=e.uid,c=e.photoURL;o({displayName:t,email:n,uid:a,photoURL:c}),j(!1),s.push("/")}else j(!1),s.push("/login")}));return function(){e()}}),[s]),Object(y.jsx)(H.Provider,{value:{user:i},children:u?Object(y.jsx)(J.a,{}):t})}var _=c.a.createContext();var q,Q,Y,Z,X,$,ee=function(e){var t=e.children,n=Object(a.useState)(!1),r=Object(k.a)(n,2),i=r[0],o=r[1],s=Object(a.useState)(""),l=Object(k.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)(!1),b=Object(k.a)(j,2),p=b[0],h=b[1],m=c.a.useContext(H).user.uid,O=c.a.useMemo((function(){return{fieldName:"members",operator:"array-contains",compareValue:m}}),[m]),x=B("rooms",O),f=c.a.useMemo((function(){return x.find((function(e){return e.id===d}))||{}}),[x,d]),v=c.a.useMemo((function(){return{fieldName:"uid",operator:"in",compareValue:f.members}}),[f.members]),g=B("user",v);return Object(y.jsx)(_.Provider,{value:{rooms:x,members:g,selectedRoom:f,isAddRoomVisible:i,setIsAddRoomVisible:o,selectedRoomId:d,setSelectedRoomId:u,isInviteMemberVisible:p,setIsInviteMemberVisible:h},children:t})},te=P.a.div(q||(q=Object(L.a)(["\n    display: flex;\n    justify-content: space-between;\n    height: 56px;\n    padding: 0 16px;\n    align-items: center;\n    border-bottom: 1px solid rgb(230, 230, 230);\n\n    .header {\n        &-info {\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n        }\n\n        &-title {\n            margin: 0;\n            font-weight: bold;\n        }\n\n        &-description {\n            font-size: 12px;\n        }\n    }\n"]))),ne=P.a.div(Q||(Q=Object(L.a)(["\n    display: flex;\n    align-items: center;\n"]))),ae=P.a.div(Y||(Y=Object(L.a)(["\n    height: 100vh;\n"]))),ce=P.a.div(Z||(Z=Object(L.a)(["\n    height: calc(100% - 56px);\n    display: flex;\n    flex-direction: column;\n    padding: 11px;\n    justify-content: flex-end;\n    overflow-y: auto;\n"]))),re=Object(P.a)(S.a)(X||(X=Object(L.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 2px 2px 2px 0;\n    border: 1px solid rgb(230, 230, 230);\n    border-radius: 2px;\n\n    .ant-form-item {\n        flex: 1;\n        margin-bottom: 0;\n    }\n"]))),ie=P.a.div($||($=Object(L.a)([""])));var oe,se=function(){var e=c.a.useContext(_),t=e.selectedRoom,n=e.members,r=e.setIsInviteMemberVisible,i=c.a.useContext(H).user,o=i.uid,s=i.photoURL,l=i.displayName,d=Object(a.useState)(""),u=Object(k.a)(d,2),j=u[0],p=u[1],h=function(){v("messages",{text:j,uid:o,photoURL:s,roomId:t.id,displayName:l}),p("")},m=c.a.useMemo((function(){return{fieldName:"roomId",operator:"==",compareValue:t.id}}),[t.id]),O=B("messages",m);return O.sort((function(e,t){return e.createdAt-t.createdAt})),Object(y.jsx)(ae,{children:t.id?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(te,{children:[Object(y.jsxs)("div",{className:"header-info",children:[Object(y.jsx)("p",{className:"header-title",children:t.name}),Object(y.jsx)("span",{className:"header-description",children:t.description})]}),Object(y.jsxs)(ne,{children:[Object(y.jsx)(b.a,{icon:Object(y.jsx)(z.a,{}),type:"text",onClick:function(){return r(!0)},children:"M\u1eddi"}),Object(y.jsx)(V.a.Group,{size:"small",maxCount:2,children:n.map((function(e){var t,n;return Object(y.jsx)(M.a,{title:e.displayName,children:Object(y.jsx)(V.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})},e.id)}))})]})]}),Object(y.jsxs)(ce,{children:[Object(y.jsx)(ie,{children:O.map((function(e){return Object(y.jsx)(W,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createdAt:e.createdAt},e.id)}))}),Object(y.jsxs)(re,{children:[Object(y.jsx)(S.a.Item,{children:Object(y.jsx)(F.a,{placeholder:"Nh\u1eadp tin nh\u1eafn...",bordered:!1,autoComplete:"off",onChange:function(e){p(e.target.value)},onPressEnter:h,value:j})}),Object(y.jsx)(b.a,{type:"primary",onClick:h,children:"G\u1eedi"})]})]})]}):Object(y.jsx)(T.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng",type:"info",showIcon:!0,style:{margin:5},closable:!0})})},le=n(195),de=n.n(le),ue=P.a.div(oe||(oe=Object(L.a)(["\n    display: flex;\n    justify-content: space-between;\n    padding: 12px 16px;\n    border-bottom: 1px solid rgba(82, 38, 83);\n\n    .username {\n        color: white;\n        margin-left: 5px;\n    }\n"])));var je,be,pe=function(){var e,t=c.a.useContext(H).user,n=t.displayName,a=t.photoURL;return Object(y.jsxs)(ue,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(de.a,{src:a,children:a?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"username",children:n})]}),Object(y.jsx)(b.a,{ghost:!0,onClick:function(){return h.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})},he=n(375),me=n(381),Oe=he.a.Panel,xe=Object(P.a)(Oe)(je||(je=Object(L.a)(["\n    &&& {\n        .ant-collapse-header, p {\n            color: white;\n        }\n\n        .ant-collapse-content-box {\n            padding: 0 40px;\n        }\n\n        .add-room {\n            color: white;\n            padding: 0;\n        }\n    }\n"]))),fe=Object(P.a)(d.a.Link)(be||(be=Object(L.a)(["\n    display: block;\n    margin-bottom: 5px;\n    color: white;\n"])));var ve,ge=function(){var e=c.a.useContext(_),t=e.rooms,n=e.setIsAddRoomVisible,a=e.setSelectedRoomId;return Object(y.jsx)(he.a,{ghost:!0,defaultActiveKey:["1"],children:Object(y.jsxs)(xe,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[t.map((function(e){return Object(y.jsx)(fe,{onClick:function(){return a(e.id)},children:e.name},e.id)})),Object(y.jsx)(b.a,{type:"text",icon:Object(y.jsx)(me.a,{}),className:"add-room",onClick:function(){n(!0)},children:"Th\xeam ph\xf2ng"})]},"1")})},ye=P.a.div(ve||(ve=Object(L.a)(["\n    background: #3f0e40;\n    color: white;\n    height: 100vh;\n"])));var Ie=function(){return Object(y.jsx)(ye,{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(pe,{})}),Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(ge,{})})]})})};var Ce=function(){return Object(y.jsx)("div",{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:6,children:Object(y.jsx)(Ie,{})}),Object(y.jsx)(j.a,{span:18,children:Object(y.jsx)(se,{})})]})})},we=n(377);var Ne=function(){var e=S.a.useForm(),t=Object(k.a)(e,1)[0],n=Object(a.useContext)(_),c=n.isAddRoomVisible,r=n.setIsAddRoomVisible,i=Object(a.useContext)(H).user.uid;return Object(y.jsx)("div",{children:Object(y.jsx)(we.a,{title:"T\u1ea1o ph\xf2ng",visible:c,onOk:function(){v("rooms",Object(f.a)(Object(f.a)({},t.getFieldValue()),{},{members:[i]})),r(!1),t.resetFields()},onCancel:function(){r(!1),t.resetFields()},children:Object(y.jsxs)(S.a,{form:t,layout:"vertical",children:[Object(y.jsx)(S.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(y.jsx)(F.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(y.jsx)(S.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(y.jsx)(F.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})})},Re=n(205),Ue=n(374),Ae=n(196),ke=["fetchOptions","debounceTimeout"];function Le(e){var t=e.fetchOptions,n=e.debounceTimeout,r=void 0===n?300:n,i=Object(Re.a)(e,ke),o=Object(a.useState)(!1),s=Object(k.a)(o,2),l=s[0],d=s[1],u=Object(a.useState)([]),j=Object(k.a)(u,2),b=j[0],p=j[1],h=c.a.useMemo((function(){return Object(Ae.debounce)((function(e){p([]),d(!0),t(e,i.curMembers).then((function(e){p(e),d(!1)}))}),r)}),[r,t,i.curMembers]);return Object(y.jsx)(Ue.a,Object(f.a)(Object(f.a)({labelInValue:!0,filterOption:!1,onSearch:h,notFoundContent:l?Object(y.jsx)(J.a,{size:"small"}):null},i),{},{children:b.map((function(e){var t,n;return Object(y.jsxs)(Ue.a.Option,{value:e.value,title:e.label,children:[Object(y.jsx)(V.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()}),"".concat(e.label)]},e.value)}))}))}function Se(e,t){return Ve.apply(this,arguments)}function Ve(){return(Ve=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.collection("user").where("keywords","array-contains",t).limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Me=function(){var e=S.a.useForm(),t=Object(k.a)(e,1)[0],n=Object(a.useContext)(_),c=n.isInviteMemberVisible,r=n.setIsInviteMemberVisible,i=n.selectedRoomId,o=n.selectedRoom,s=Object(a.useState)([]),l=Object(k.a)(s,2),d=l[0],u=l[1];return Object(y.jsx)("div",{children:Object(y.jsx)(we.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:c,onOk:function(){t.resetFields(),r(!1),m.collection("rooms").doc(i).update({members:[].concat(Object(x.a)(o.members),Object(x.a)(d.map((function(e){return e.value}))))})},onCancel:function(){r(!1),t.resetFields()},children:Object(y.jsx)(S.a,{form:t,layout:"vertical",children:Object(y.jsx)(Le,{mode:"multiple",label:"T\xean c\xe1c th\xe0nh vi\xean",value:d,placeholder:"Nh\u1eadp t\xean c\xe1c th\xe0nh vi\xean",fetchOptions:Se,onChange:function(e){return u(e)},style:{width:"100%"},curMembers:o.members})})})})};var Fe=function(){return Object(y.jsx)(U.a,{children:Object(y.jsx)(K,{children:Object(y.jsxs)(ee,{children:[Object(y.jsxs)(A.c,{children:[Object(y.jsx)(A.a,{component:R,path:"/login"}),Object(y.jsx)(A.a,{component:Ce,path:"/"})]}),Object(y.jsx)(Ne,{}),Object(y.jsx)(Me,{})]})})})},Te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,382)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(Fe,{})}),document.getElementById("root")),Te()}},[[365,1,2]]]);
//# sourceMappingURL=main.572b6e80.chunk.js.map